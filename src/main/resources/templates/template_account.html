<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <title>Spring Pet Store</title>
    <style>
        * {
            font-family: 'Open Sans', Helvetica; font-size: small;
        }
        body {
            margin: auto;
            width: 99%;
            border: 1px solid red;
            padding: 5px;
        }
        .main-container {
            margin: auto;
            width: 600px;
            display: flex;
            flex-direction: column;
            border: 1px solid red;
            padding: 5px;
        }
        .header-container {
            font-size: small;
        }
        .title-container {
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 5px;
            font-size: small;
            border: 1px solid red;
        }
        .profile-container {
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 5px;
            font-size: small;
            border: 1px solid red;
        }
        .profile-subcontainer {
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 5px;
            font-size: small;
            border: 1px solid red;
        }
        .order-container {
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 5px;
            font-size: small;
            border: 1px solid red;
        }
        .order-subcontainer {
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 5px;
            font-size: small;
            border: 1px solid red;
        }
        .footer-container {
            border: 1px solid red;
            padding: 5px;
            text-align: center;
        }
        .button:disabled {
            color: #666;
        }
        .title {
            font-weight: bold;
        }
          a {
            color: black;
        }
        a:visited {
            color: black;
        }


    </style>
</head>
<body>
<div class="main-container">
    <div class="header-container" th:insert="~{fragments/fragment_header :: header}"></div>
    <div class="title-container">
        <div class="title">ACCOUNT</div>
    </div>
    <div class="profile-container">
        <div class="title">PROFILE</div>
        <div class="profile-subcontainer">
            <table>
                <tr>
                    <td>Username:</td>
                    <td th:text="${user.username}"></td>
                </tr>
                <tr>
                    <td>Change password:</td>
                    <td>
                        <form action="/account/password/change" method="post">
                            <input type="text" size="16" name="old_password" placeholder="Old password*" required>
                            <input type="text" size="16" name="new_password" placeholder="New password*">
                            <button type="submit">CHANGE PASSWORD</button>
                        </form>
                    </td>
                </tr>
                <tr>
                    <td>User role:</td>
                    <td sec:authentication="principal.authorities"></td>
                </tr>
                <tr>
                    <td>First name:</td>
                    <td th:text="${user.firstName}"></td>
                </tr>
                <tr>
                    <td>Last name:</td>
                    <td th:text="${user.lastName}"></td>
                </tr>
                <tr>
                    <td>Email:</td>
                    <td th:text="${user.email}"></td>
                </tr>
                <tr>
                    <td>Phone:</td>
                    <td th:text="${user.phone}"></td>
                </tr>
                <tr>
                    <td colspan="2" align="center">
                        <form action="/account/user/delete" method="get">
                            <input type="hidden" name="user_id" th:value=${user.id}>
                            <span sec:authorize="!hasRole('ROLE_ADMIN')"><button
                                    type="submit">DELETE ACCOUNT</button></span>
                            <span sec:authorize="hasRole('ROLE_ADMIN')"><button type="submit"
                                                                                disabled>DELETE ACCOUNT</button></span>
                        </form>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="order-container">
        <div class="title">ORDERS</div>
        <div class="order-subcontainer">
            <table>
                <div style="text-align: center" th:if="${orders.empty}">You have no orders.</div>
                <div th:unless="${orders.empty}">
                    <tr>
                        <td>Order Id</td>
                        <td>Pet name</td>
                        <td>Quantity</td>
                        <td>Ship date</td>
                        <td>Status</td>
                        <td>Order complete</td>
                    </tr>
                </div>
                <tr th:each="order:${orders}">
                    <td th:text="${order.id}"></td>
                    <td th:text="${order.pet.name}"></td>
                    <td th:text="${order.quantity}"></td>
                    <td th:text="${order.shipDate}"></td>
                    <td th:text="${order.status}"></td>
                    <td th:text="${order.complete}"></td>
                    <td>
                        <form action="/account/order/delete" method="post">
                            <input type="hidden" name="order_id" th:value=${order.id}>
                            <input type="hidden" name="pet_id" th:value=${order.pet.id}>
                            <button type="submit">CANCEL ORDER</button>
                        </form>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="footer-container" th:insert="~{fragments/fragment_footer :: footer}"></div>
</div>
</body>
</html>